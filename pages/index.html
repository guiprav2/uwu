<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title></title>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <script>
      window.rootPrefix = /^\/(files|preview)\//.test(location.pathname)
        ? location.pathname.split('/').slice(0, 4).join('/')
        : '/';
    </script>
    <script type="module" src="../webfoundry/ifdesigner.js"></script>
    <script src="../webfoundry/head.js"></script>
  </head>
  <body
    class="flex flex-col [&amp;&gt;div:first-child]:flex-1 min-h-screen"
    style="display: none"
  >
    <div
      class="min-h-screen flex flex-col sm:flex-row w-screen"
      wf-onattach="post('app.init')"
    >
      <style>
        em {
          font-style: normal;
          font-weight: bold;
        }
      </style>
      <div
        class="flex-col gap-3 p-8 z-10 shadow-xl flex w-screen sm:w-80 md:w-96 min-h-screen bg-neutral-100"
        wf-class=""
      >
        <div class="flex items-center gap-2 pl-3">
          <div class="nf nf-oct-log text-lg"></div>
          <div>Projects</div>
          <div class="flex-1"></div>
          <div class="flex items-center gap-0.5 text-gray-400">
            <button
              class="nf p-1.5 outline-none rounded-full hover:text-gray-800 nf-fa-clone"
              wf-onclick="post('main.cloneThread')"
              wf-if="state.main.thread.logs.filter(x =&gt; !x.priming).length"
              value=""
            ></button>
            <button
              class="nf p-1.5 outline-none rounded-full hover:text-gray-800 nf-md-qrcode"
              wf-if="state.main.thread.logs.filter(x =&gt; !x.priming).length"
              hidden=""
              value=""
            ></button>
            <button
              class="nf p-1.5 outline-none rounded-full hover:text-gray-800 nf-md-filter_outline"
              wf-class="{{state.main.showFilter &amp;&amp; 'bg-gray-200 text-gray-800'}} {{state.main.options.filter.length &amp;&amp; 'text-blue-600 hover:text-blue-600'}}"
              wf-onclick="post('main.toggleShowFilter', event)"
              wf-if="state.main.displayedThreads.length &amp;&amp; (state.main.options.filter.length || state.main.tags.length)"
              value=""
            ></button>
            <button
              class="nf p-1.5 outline-none rounded-full hover:text-gray-800 nf-md-archive_search"
              wf-onclick="post('main.toggleArchives', event)"
              wf-class="{{state.main.panel === 'archives' &amp;&amp; 'bg-gray-200 text-gray-800'}}"
              value=""
            ></button>
          </div>
        </div>

        <!-- Typeahead input -->
        <!-- Display currently selected tags -->
        <div
          class="flex items-center gap-1.5 flex-wrap"
          wf-if="state.main.showFilter"
        >
          <div
            class="text-sm px-2 py-0.5 rounded-full shrink-0 flex items-center gap-2 bg-blue-200 text-blue-600"
            wf-map="x of state.main.options.filter.slice().sort()"
          >
            <div class="relative -top-[1px]">{{x}}</div>
            <button
              class="relative -top-[1px] outline-none"
              wf-onclick="post('main.rmfilter', x)"
              value=""
            >
              Ã—
            </button>
          </div>
          <button
            class="nf nf-fa-plus text-gray-400 outline-none text-sm px-1 py-0.5"
            wf-onclick="post('main.toggleFilterInput')"
            wf-if="!state.main.showFilterInput &amp;&amp; state.main.options.filter.length"
            value=""
          ></button>
          <div
            class="relative min-w-20 flex-1"
            wf-if="state.main.showFilterInput || !state.main.options.filter.length"
          >
            <input
              type="text"
              placeholder="add filter"
              class="border px-2 py-0.5 outline-none w-32 text-sm rounded-full text-center w-full"
              value=""
              id="taginput"
              wf-onkeyup="post('main.filterKeyUp', event)"
              wf-onblur="post('main.toggleFilterInput')"
            />
            <div
              class="border p-2 rounded bg-white shadow max-h-48 overflow-auto absolute left-1 right-1 flex flex-col text-sm gap-1 top-[110%]"
              wf-if="document.querySelector('#taginput').value.trim() || state.main.tagSuggestions.length"
              hidden=""
            >
              <button
                class="underline text-blue-600"
                wf-map="x of state.main.tagSuggestions.slice().sort()"
                wf-onclick="post('main.filter', x)"
                value=""
              >
                {{x}}
              </button>
              <div
                class="text-center"
                wf-if="!state.main.tagSuggestions.length"
              >
                no such tag found
              </div>
            </div>
          </div>
        </div>
        <!-- Suggestion dropdown -->

        <!-- Settings side panel -->
        <!-- Settings side panel -->

        <div
          wf-if="state.app.panel === 'projects' &amp;&amp; !state.app.displayedProjects.length"
          class="flex-1 flex flex-col justify-center items-center gap-4"
        >
          <div class="nf nf-fa-star text-6xl text-gray-300"></div>
          <div class="text-gray-400">Start a new project!</div>
        </div>
        <div
          class="flex-1 flex flex-col gap-1.5 min-h-0 overflow-auto basis-0 min-h-10"
          wf-if="state.app.displayedProjects.length"
        >
          <div class="" wf-map="x of state.app.displayedProjects">
            <button
              class="rounded-lg border border-[#dfe2e5] bg-white shadow px-3 py-2 flex items-center justify-between group text-sm hover:bg-gray-900 hover:text-white outline-none w-full lightweight"
              wf-onclick="post('main.openThread', thread)"
              value=""
            >
              <div class="flex items-center gap-1.5">
                <div class="text-left">{{x.name}}</div>
                <div
                  class="text-base nf nf-md-fire text-gray-400 group-hover:text-gray-300"
                  wf-if="x.tags?.includes?.('eromanga')"
                ></div>
              </div>
              <div class="flex gap-1.5 items-center">
                <div
                  class="nf nf-fa-archive hidden group-hover:block text-gray-300 flex justify-center items-center relative top-[1px] hover:text-gray-100"
                  wf-if="!thread.archived"
                  wf-onclick="post('main.toggleThreadArchived', event, thread)"
                ></div>
                <div
                  class="nf hidden group-hover:block text-gray-300 nf-md-replay flex justify-center items-center hover:text-gray-100"
                  wf-if="thread.archived"
                  wf-onclick="post('main.toggleThreadArchived', event, thread)"
                ></div>
                <div
                  class="nf hidden group-hover:block text-gray-300 nf-oct-x flex justify-center items-center relative top-[1px] hover:text-gray-100"
                  wf-if="thread.archived"
                  wf-onclick="post('main.rmThread', event, thread)"
                ></div>
              </div>
            </button>
          </div>
        </div>

        <button
          class="rounded-lg border border-[#dfe2e5] bg-white shadow px-3 py-2 group text-center hover:text-white hover:bg-gray-900 outline-none"
          wf-if="!state.app.viewingArchived"
          wf-onclick="post('main.createNewThread')"
          value=""
        >
          New Project
        </button>
        <button
          class="rounded-lg border border-[#dfe2e5] bg-white shadow px-3 py-2 group text-center hover:text-white hover:bg-gray-900 outline-none sm:hidden"
          wf-onclick="post('main.toggleSidebar')"
          value=""
        >
          Close
        </button>
      </div>
      <div class="flex-1 flex flex-col">
        <div
          class="flex-1 flex flex-col justify-center items-center gap-4"
          wf-if="!state.app.project"
        >
          <div class="nf nf-fa-star text-6xl text-gray-300"></div>
          <div class="text-gray-400">Start a new project!</div>
        </div>
        <div
          class="flex-1 bg-white border-l border-gray-300 flex flex-col relative sm:pl-8 h-screen p-3 sm:p-8 gap-3 sm:gap-8"
          wf-if="state.app.project"
          wf-class=""
        >
          <div wf-if="state.app.project.name">
            <div class="flex items-center group flex-wrap gap-y-1 gap-x-1.5">
              <div class="text-xl sm:text-3xl">
                {{state.app.project.name || '...'}}
              </div>

              <div
                class="text-3xl"
                wf-if="state.app.project.tags.includes('eromanga')"
              >
                ðŸ¥µ
              </div>
            </div>
            <div
              class="flex items-center gap-1.5 group flex-wrap mt-3 overflow-auto max-h-[15vh]"
            >
              <div class="text-sm relative -top-[1px]">
                {{state.app.project.tags?.length ? 'Tags:' : 'Tags'}}
              </div>
              <div
                class="text-sm px-2 py-0.5 rounded-full shrink-0 flex items-center gap-2 bg-green-200 text-green-600"
                wf-map="x of state.app.project.tags?.slice?.()?.sort?.() || []"
              >
                <div class="relative -top-[1px]">{{x}}</div>
                <button
                  class="relative -top-[1px] outline-none"
                  wf-onclick="post('main.rmTag', x)"
                  value=""
                >
                  Ã—
                </button>
              </div>
              <button
                class="nf nf-fa-plus text-gray-400 outline-none text-sm px-1 py-0.5"
                wf-onclick="post('main.toggleTagInput')"
                value=""
              ></button>
              <label
                class="relative min-w-20"
                wf-if="state.main.projecttmp.showTagInput"
              >
                <input
                  type="text"
                  placeholder="add tag"
                  class="border px-2 py-0.5 outline-none text-sm rounded-full text-center w-full"
                  id="taginput2"
                  wf-onkeyup="post('main.tagKeyUp', event)"
                  wf-onblur="setTimeout(() =&gt; post('main.toggleTagInput'), 200)"
                  value=""
                />
                <div
                  class="border p-2 rounded bg-white shadow max-h-48 overflow-auto absolute left-1 right-1 flex flex-col text-sm gap-1 top-[110%] z-10"
                  wf-if="state.main.projecttmp.tagSuggestions?.length"
                  hidden=""
                >
                  <button
                    class="underline text-blue-600 outline-none"
                    wf-map="x of state.main.projecttmp.tagSuggestions"
                    wf-onclick="post('main.addTag', x)"
                    value=""
                  >
                    {{x}}
                  </button>
                </div>
              </label>
            </div>
          </div>

          <div class="flex-1 overflow-auto pb-1 grid grid-cols-2 gap-2">
            <textarea
              class="flex-1 whitespace-pre-wrap font-thin text-2xl placeholder:italic sticky top-0 bottom-0"
              wf-value="state.app.page.transcription"
              placeholder="Add a transcription of this page here..."
              value=""
            ></textarea>

            <img
              class="w-full sticky top-0 bottom-0"
              src="https://i1.nhentai.net/galleries/2966373/3.jpg"
              wf-src="state.app.page.img"
            />
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
