<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title></title>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1"
    />
    <script>
      window.rootPrefix = /^\/(files|preview)\//.test(location.pathname)
        ? location.pathname.split('/').slice(0, 4).join('/')
        : '/';
    </script>
    <script type="module" src="../webfoundry/ifdesigner.js"></script>
    <script src="../webfoundry/head.js"></script>
  </head>
  <body
    class="flex flex-col [&amp;&gt;div:first-child]:flex-1 min-h-screen"
    style="display: none"
  >
    <div
      class="min-h-screen flex flex-col sm:flex-row w-screen"
      wf-onattach="post('app.init')"
    >
      <style>
        em {
          font-style: normal;
          font-weight: bold;
        }
      </style>
      <div
        class="flex-col gap-3 p-8 z-10 shadow-xl flex w-screen sm:w-80 md:w-96 min-h-screen bg-neutral-100"
        wf-class=""
      >
        <div class="flex items-center gap-2 pl-3">
          <div class="nf nf-oct-log text-lg"></div>
          <div>Projects</div>
          <div class="flex-1"></div>
          <div class="flex items-center gap-0.5 text-gray-400">
            <button
              class="nf p-1.5 outline-none rounded-full hover:text-gray-800 nf-fa-clone"
              wf-onclick="post('app.clone')"
              value=""
            ></button>
            <button
              class="nf p-1.5 outline-none rounded-full hover:text-gray-800 nf-md-filter_outline"
              wf-if="state.app.displayedProjects.length &amp;&amp; (state.app.options.filter.length || state.app.tags.length)"
              value=""
              wf-onclick="post('app.toggleShowFilter', event)"
              wf-class="{{state.app.showFilter &amp;&amp; 'bg-gray-200 text-gray-800'}} {{state.app.options.filter.length &amp;&amp; 'text-blue-600 hover:text-blue-600'}}"
            ></button>
            <button
              class="nf p-1.5 outline-none rounded-full hover:text-gray-800 nf-md-archive_search"
              wf-class="{{state.app.panel === 'archives' &amp;&amp; 'bg-gray-200 text-gray-800'}}"
              wf-onclick="post('app.toggleArchives', event)"
              value=""
            ></button>
          </div>
        </div>

        <!-- Typeahead input -->
        <!-- Display currently selected tags -->
        <div
          class="flex items-center gap-1.5 flex-wrap"
          wf-if="state.app.showFilter"
        >
          <div
            class="text-sm px-2 py-0.5 rounded-full shrink-0 flex items-center gap-2 bg-blue-200 text-blue-600"
            wf-map="x of state.app.options.filter.slice().sort()"
          >
            <div class="relative -top-[1px]">{{x}}</div>
            <button
              class="relative -top-[1px] outline-none"
              wf-onclick="post('app.rmfilter', x)"
              value=""
            >
              Ã—
            </button>
          </div>
          <button
            class="nf nf-fa-plus text-gray-400 outline-none text-sm px-1 py-0.5"
            wf-onclick="post('app.toggleFilterInput')"
            wf-if="!state.app.showFilterInput &amp;&amp; state.app.options.filter.length"
            value=""
          ></button>
          <div
            class="relative min-w-20 flex-1"
            wf-if="state.app.showFilterInput || !state.app.options.filter.length"
          >
            <input
              type="text"
              placeholder="add filter"
              class="border px-2 py-0.5 outline-none w-32 text-sm rounded-full text-center w-full"
              value=""
              id="taginput"
              wf-onkeyup="post('app.filterKeyUp', event)"
              wf-onblur="post('app.toggleFilterInput')"
            />
            <div
              class="border p-2 rounded bg-white shadow max-h-48 overflow-auto absolute left-1 right-1 flex flex-col text-sm gap-1 top-[110%]"
              wf-if="document.querySelector('#taginput').value.trim() || state.app.tagSuggestions.length"
              hidden=""
            >
              <button
                class="underline text-blue-600"
                wf-map="x of state.app.tagSuggestions.slice().sort()"
                wf-onclick="post('app.filter', x)"
                value=""
              >
                {{x}}
              </button>
              <div class="text-center" wf-if="!state.app.tagSuggestions.length">
                no such tag found
              </div>
            </div>
          </div>
        </div>
        <!-- Suggestion dropdown -->

        <!-- Settings side panel -->
        <!-- Settings side panel -->

        <div
          wf-if="state.app.panel === 'projects' &amp;&amp; !state.app.displayedProjects.length"
          class="flex-1 flex flex-col justify-center items-center gap-4"
        >
          <div class="nf nf-fa-star text-6xl text-gray-300"></div>
          <div class="text-gray-400">Start a new project!</div>
        </div>
        <div
          class="flex-1 flex flex-col gap-1.5 min-h-0 overflow-auto basis-0 min-h-10"
          wf-if="state.app.displayedProjects.length"
        >
          <div class="" wf-map="x of state.app.displayedProjects">
            <button
              class="rounded-lg border border-[#dfe2e5] bg-white shadow px-3 py-2 flex items-center justify-between group text-sm hover:bg-gray-900 hover:text-white outline-none w-full lightweight"
              wf-onclick="post('app.selectProject', x)"
              value=""
            >
              <div class="flex items-center gap-1.5">
                <div class="text-left">{{x.title || 'Untitled'}}</div>
                <div
                  class="text-base nf nf-md-fire text-gray-400 group-hover:text-gray-300"
                  wf-if="x.tags?.includes?.('eromanga')"
                ></div>
              </div>
              <div class="flex gap-1.5 items-center">
                <div
                  class="nf nf-fa-archive hidden group-hover:block text-gray-300 flex justify-center items-center relative top-[1px] hover:text-gray-100"
                  wf-if="!x.archived"
                  wf-onclick="post('app.toggleArchived', event, x)"
                ></div>
                <div
                  class="nf hidden group-hover:block text-gray-300 nf-md-replay flex justify-center items-center hover:text-gray-100"
                  wf-if="x.archived"
                  wf-onclick="post('app.toggleArchived', event, x)"
                ></div>
                <div
                  class="nf hidden group-hover:block text-gray-300 nf-oct-x flex justify-center items-center relative top-[1px] hover:text-gray-100"
                  wf-if="x.archived"
                  wf-onclick="post('app.rm', event, x)"
                ></div>
              </div>
            </button>
          </div>
        </div>

        <button
          class="rounded-lg border border-[#dfe2e5] bg-white shadow px-3 py-2 group text-center hover:text-white hover:bg-gray-900 outline-none"
          value=""
          wf-if="!state.app.viewingArchived"
          wf-onclick="post('app.newProject')"
        >
          New Project
        </button>
      </div>
      <div class="flex-1 flex flex-col">
        <div
          class="flex-1 flex flex-col justify-center items-center gap-4 py-16 border-l border-gray-300"
          wf-if="!state.app.project"
          hidden=""
        >
          <div class="nf nf-fa-star text-6xl text-gray-300"></div>
          <div class="text-gray-400">Start a new project!</div>
        </div>
        <div
          class="bg-white border-l border-gray-300 flex flex-col relative sm:pl-8 h-screen p-3 sm:p-8 gap-3 sm:gap-8 overflow-hidden"
          wf-if="state.app.project"
          wf-class=""
        >
          <div wf-if="state.app.project.title">
            <div class="flex justify-between">
              <div class="flex items-center group flex-wrap gap-y-1 gap-x-1.5">
                <div class="text-xl sm:text-3xl">
                  {{state.app.project.title || '...'}}
                </div>

                <div class="flex items-center gap-2 ml-2">
                  <div
                    class="text-3xl"
                    wf-if="state.app.project.tags.includes('eromanga')"
                  >
                    ðŸ¥µ
                  </div>
                  <div
                    class="nf text-3xl animate-pulse nf-cod-mic_filled"
                    wf-if="state.app.tmp.recording"
                    hidden=""
                  ></div>
                  <div
                    class="nf text-3xl animate-pulse nf-md-transcribe"
                    wf-if="state.app.tmp.transcribing"
                    hidden=""
                  ></div>
                  <div
                    class="nf nf-md-chat_processing_outline text-3xl animate-pulse"
                    wf-if="state.app.tmp.busy"
                    hidden=""
                  ></div>
                </div>
              </div>
              <div class="flex gap-2">
                <button
                  class="w-10 h-10 rounded-full bg-neutral-950/80 text-neutral-50 flex items-center nf justify-center nf-cod-mic_filled disabled:opacity-50"
                  value=""
                  wf-onclick="post('app.transcribe')"
                  wf-disabled="!state.app.project?.pages?.length || state.app.tmp.busy"
                  wf-class="{{replaces nf-cod-mic_filled: !state.app.tmp.recording ? 'nf-cod-mic_filled' : (!state.app.tmp.transcribing ? 'nf-oct-check' : 'nf-oct-x')}}"
                ></button
                ><button
                  class="w-10 h-10 rounded-full bg-neutral-950/80 text-neutral-50 flex items-center nf nf-fa-chevron_left justify-center disabled:opacity-50"
                  value=""
                  wf-onclick="state.app.tmp.page--, d.update()"
                  wf-disabled="state.app.tmp.page &lt;= 0"
                ></button>
                <button
                  class="w-10 h-10 rounded-full bg-neutral-950/80 text-neutral-50 flex items-center nf justify-center nf-fa-plus disabled:opacity-50"
                  value=""
                  wf-onclick="post('app.newPage')"
                  wf-disabled="state.app.tmp.page &gt;= state.app.project.pages.length - 1"
                ></button>
                <button
                  class="w-10 h-10 rounded-full bg-neutral-950/80 text-neutral-50 flex items-center nf justify-center nf-fa-chevron_right disabled:opacity-50"
                  wf-disabled="state.app.tmp.page &gt;= state.app.project.pages.length - 1"
                  wf-onclick="state.app.tmp.page++, d.update()"
                  value=""
                ></button>
              </div>
            </div>
            <div
              class="flex items-center gap-1.5 group flex-wrap mt-3 overflow-auto max-h-[15vh]"
            >
              <div class="text-sm relative -top-[1px]">
                {{state.app.project.tags?.length ? 'Tags:' : 'Tags'}}
              </div>
              <div
                class="text-sm px-2 py-0.5 rounded-full shrink-0 flex items-center gap-2 bg-green-200 text-green-600"
                wf-map="x of state.app.project.tags?.slice?.()?.sort?.() || []"
              >
                <div class="relative -top-[1px]">{{x}}</div>
                <button
                  class="relative -top-[1px] outline-none"
                  wf-onclick="post('app.rmTag', x)"
                  value=""
                >
                  Ã—
                </button>
              </div>
              <button
                class="nf nf-fa-plus text-gray-400 outline-none text-sm px-1 py-0.5"
                wf-onclick="post('app.toggleTagInput')"
                value=""
              ></button>
              <label
                class="relative min-w-20"
                wf-if="state.app.tmp.showTagInput"
              >
                <input
                  type="text"
                  placeholder="add tag"
                  class="border px-2 py-0.5 outline-none text-sm rounded-full text-center w-full"
                  id="taginput2"
                  wf-onkeyup="post('app.tagKeyUp', event)"
                  wf-onblur="setTimeout(() =&gt; post('app.toggleTagInput'), 200)"
                  value=""
                />
                <div
                  class="border p-2 rounded bg-white shadow max-h-48 overflow-auto absolute left-1 right-1 flex flex-col text-sm gap-1 top-[110%] z-10"
                  wf-if="state.app.tmp.tagSuggestions?.length"
                  hidden=""
                >
                  <button
                    class="underline text-blue-600 outline-none"
                    wf-map="x of state.app.tmp.tagSuggestions"
                    wf-onclick="post('app.addTag', x)"
                    value=""
                  >
                    {{x}}
                  </button>
                </div>
              </label>
            </div>
          </div>

          <div
            class="flex-1 overflow-auto pb-1 grid grid-cols-2 gap-2"
            wf-if="state.app.project.pages[state.app.tmp.page]"
          >
            <textarea
              class="flex-1 whitespace-pre-wrap font-thin text-2xl placeholder:italic sticky top-0 bottom-0 outline-none"
              wf-value="state.app.project.pages[state.app.tmp.page].transcription"
              placeholder="Add a transcription of this page here..."
              value=""
              wf-onkeyup="post('app.persist')"
              spellcheck="false"
            ></textarea>

            <img
              class="w-full sticky top-0 bottom-0"
              src="https://i1.nhentai.net/galleries/2966373/3.jpg"
              wf-src="state.app.project.pages[state.app.tmp.page].img"
            />
          </div>
          <div
            id="inputbox"
            class="rounded-lg border bg-white shadow flex items-center justify-between group text-sm hover:bg-gray-100 relative border-[#dfe2e5]"
            wf-if="state.app.project.pages[state.app.tmp.page].transcription.trim()"
          >
            <textarea
              class="flex-1 bg-transparent outline-none resize-none p-4 sm:pr-4 pr-16 max-h-[10rem] h-[3.25rem]"
              placeholder="Type a message"
              wf-onkeyup="rawctrls.app.actions.msgKeyUp(event)"
              value=""
              wf-onkeydown="rawctrls.app.actions.msgKeyDown(event)"
            ></textarea>
            <div
              class="self-stretch flex border-l border-[#dfe2e5] relative items-center group"
              wf-if="state.app.models.length || state.app.tmp.loadingModels"
            >
              <div
                class="absolute bottom-[100%] right-0 pb-2 min-w-64"
                wf-if="state.app.tmp.showModels"
                id="modellist"
                hidden=""
              >
                <div
                  class="border p-2 rounded bg-white shadow max-h-48 overflow-auto left-1 right-1 flex flex-col text-sm gap-1 z-10 border-slate-300"
                >
                  <button
                    class="text-blue-600 outline-none flex justify-between items-center gap-3 text-left"
                    wf-onclick="post('app.changeModel', x.id)"
                    value=""
                    wf-map="x of state.app.models"
                  >
                    <div class="underline">{{x.id.split(':')[1]}}</div>
                    <div
                      class="text-sm truncate max-w-24 decoration-none text-slate-500 shrink-0"
                    >
                      {{new Date(x.created * 1000).toLocaleString('en-US', { month: 'short', year: 'numeric' })}}
                    </div>
                  </button>
                </div>
              </div>
              <button
                class="px-4 h-full text-gray-600 hover:text-gray-900 outline-none truncate md:max-w-64 max-w-30"
                wf-if="!state.app.tmp.loadingModels"
                wf-onclick="post('app.toggleShowModels')"
                value=""
              >
                {{state.app.model.split(':')[1]}}
              </button>
              <div
                class="nf text-gray-500 text-xl w-8 h-8 flex justify-center items-center nf-fa-spinner animate-spin mx-4"
                wf-if="state.app.tmp.loadingModels"
                hidden=""
              ></div>
              <div
                class="nf text-gray-500 text-xl w-8 h-8 justify-center items-center mx-4 nf-weather-refresh hidden group-hover:flex"
                wf-onclick="post('app.listModels')"
                wf-if="!state.app.tmp.loadingModels"
              ></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
